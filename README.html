<h1 id="challenge-conversion-manytomany">Challenge Conversion ManyToMany</h1>
<h2 id="préambule">Préambule</h2>
<p>Après avoir cloné :</p>
<ul>
<li>Installer les vendors via <code>composer install</code></li>
<li>Créez votre fichier <code>.env.local</code></li>
<li>Exécuter les migrations en local chez vous via <code>php bin/console doctrine:migrations:migrate</code>  <br />
(il ne faut surtout pas créer de migration avant un premier <code>d:m:m</code>)</li>
</ul>
<h2 id="objectifs">Objectifs</h2>
<blockquote>
  <p>Les entités Genre, Movie et Person sont déjà créées !</p>
</blockquote>
<p>Créer une <em>vraie</em> entité avec des champs additionnels entre <code>Movie</code> et <code>Person</code>.  <br />
L'idée est de convertir la relation <code>ManyToMany</code> en une vraie entité (classe PHP) <code>ManyToOne/OneToMany</code>, comme décrit sur ce schéma ci-dessous :</p>
<p><img src="assets/docs/aide/symfony/themes/img/conversion-m2m-m2o.svg" alt="" /></p>
<ul>
<li>Nous appellerons cette liaison (entité) <code>Casting</code> et elle contiendra deux propriétés :</li>
<li><code>role</code> : rôle de la personne dans le film.</li>
<li><code>creditOrder</code> ordre d'affichage de ce rôle sur la fiche du film.</li>
<li>Et bien sûr les deux relations vers <code>Movie</code> et <code>Person</code> !<ul>
<li>Note : N'oubliez pas de supprimer la relation ManyToMany d'origine dans chaque entité <code>Movie</code> et <code>Person</code> (propriété, construct, les 3 getters/setters)</li></ul></li>
<li>Faites en sorte de créer le schéma Doctrine qui fonctionne (vérifiez dans le concepteur PMA si ça correspond).</li>
<li>En code (dans un controller par exemple), ajoutez des personnes et des films à <code>Casting</code> et sauvegardez-les en BDD.</li>
<li>Affichez la liste des films sur la page principale.</li>
<li>Affichez le détail de chaque film avec <strong>TOUTES</strong> les infos liées dans une autre page.</li>
</ul>
<h4 id="bonus">Bonus</h4>
<p>Trouver le moyen de classer automatiquement les acteurs par ordre de <code>creditOrder</code>.</p>
<h2 id="ressources">Ressources</h2>
<ul>
<li>Si besoin <a href="http://docs.doctrine-project.org/projects/doctrine-orm/en/latest/tutorials/composite-primary-keys.html#use-case-3-join-table-with-metadata">tuto disponible sur le site de Doctrine</a> (cet exemple insiste plus particulièrement sur les clés primaires <em>composées</em> de la table de jointure).</li>
</ul>
<p>Exemple MCD avec clef composite</p>
<p><details></p>
<p><img src="assets/docs/aide/symfony/themes/img/mcd-casting-m2m-m2o-concat-key.png" alt="" /></p>
<p></details></p>